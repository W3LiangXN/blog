# 由图片上传引出的问题及其解决方式
### 问题出现背景
  开发一个[AI纽约时报上传系统](https://ai.sunzi.cool/), 提供给AI部门上传图片, 需要把原图上传到OSS上以及把原图经过加水印处理后上传到七牛云。页面提供一个选择图片的按钮, 供用户选择图片。一开始的做法是，图片一张一张的处理，处理完第一张才去执行第二张图片的任务，但是这种方式明显会很慢，假如上一张图片处理很慢，就会导致第二张停顿很久。所以后面改成多图片并行上传的方式，但是也遇到了问题，就是请求并发量太大，导致页面卡顿，容易造成请求失败。所以最后的处理方式时，限制请求并发量，设计一个请求队列，给定一个阈值， 假如当前请求数量超过这个阈值，则让该请求有去排队，一步一步把请求队列执行完成。
